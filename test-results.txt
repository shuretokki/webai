
  [90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[31;1mâ¨¯[39;22m[31;1mâ¨¯[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[31;1mâ¨¯[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[31;1mâ¨¯[39;22m[90;1m.[39;22m[31;1mâ¨¯[39;22m[31;1mâ¨¯[39;22m[31;1mâ¨¯[39;22m[90;1m.[39;22m[31;1mâ¨¯[39;22m[90;1m.[39;22m[31;1mâ¨¯[39;22m[31;1mâ¨¯[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[31;1mâ¨¯[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m
  [90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[31;1mâ¨¯[39;22m[90;1m.[39;22m[31;1mâ¨¯[39;22m[31;1mâ¨¯[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[33;1ms[39;22m[33;1ms[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m
  [90;1m.[39;22m[90;1m.[39;22m[31;1mâ¨¯[39;22m[31;1mâ¨¯[39;22m[31;1mâ¨¯[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[31;1mâ¨¯[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[31;1mâ¨¯[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[31;1mâ¨¯[39;22m[90;1m.[39;22m[90;1m.[39;22m[31;1mâ¨¯[39;22m[31;1mâ¨¯[39;22m[31;1mâ¨¯[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[31;1mâ¨¯[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[31;1mâ¨¯[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[90;1m.[39;22m[31;1mâ¨¯[39;22m[90;1m.[39;22m[31;1mâ¨¯[39;22m[31;1mâ¨¯[39;22m[90;1m.[39;22m[31;1mâ¨¯[39;22m[31;1mâ¨¯[39;22m[31;1mâ¨¯[39;22m[31;1mâ¨¯[39;22m[31;1mâ¨¯[39;22m
  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\IntegrationTest[22m [90m>[39m multi-â€¦ [41;1m PrismRateLimitedException [49;22m  
[39;1m  You hit a provider rate limit. Details: [][39;22m

  at [32mvendor/prism-php/prism/src/Exceptions/PrismRateLimitedException.php[39m:[32m34[39m
     30â–•      * @param  ProviderRateLimit[]  $rateLimits
     31â–•      */
     32â–•     public static function make(array $rateLimits = [], ?int $retryAfter = null): self
     33â–•     {
  âžœ  34â–•         return new self(rateLimits: $rateLimits, retryAfter: $retryAfter);
     35â–•     }
     36â–• }
     37â–•

      [2m+4 vendor frames [22m
  [33m5   [39m[39;1mapp/Jobs/GenerateChatTitle.php[39;22m:[39;1m36[39;22m
      [2m+22 vendor frames [22m
  [33m28  [39m[39;1mapp/Http/Controllers/ChatController.php[39;22m:[39;1m260[39;22m

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\IntegrationTest[22m [90m>[39m social authenticaâ€¦ [41;1m QueryException [49;22m  
[39;1m  SQLSTATE[23000]: Integrity constraint violation: 19 NOT NULL constraint failed: social_identities.provider_name (Connection: sqlite, SQL: insert into "social_identities" ("user_id", "provider_id", "updated_at", "created_at") values (1, 123456, 2025-12-22 15:53:30, 2025-12-22 15:53:30))[39;22m

  at [32mvendor/laravel/framework/src/Illuminate/Database/Connection.php[39m:[32m570[39m
    566â–•             $this->bindValues($statement, $this->prepareBindings($bindings));
    567â–• 
    568â–•             $this->recordsHaveBeenModified();
    569â–• 
  âžœ 570â–•             return $statement->execute();
    571â–•         });
    572â–•     }
    573â–• 
    574â–•     /**

      [2m+17 vendor frames [22m
  [33m18  [39m[39;1mtests/Feature/IntegrationTest.php[39;22m:[39;1m413[39;22m

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\IntegrationTest[22m [90m>[39m compleâ€¦ [41;1m PrismRateLimitedException [49;22m  
[39;1m  You hit a provider rate limit. Details: [][39;22m

  at [32mvendor/prism-php/prism/src/Exceptions/PrismRateLimitedException.php[39m:[32m34[39m
     30â–•      * @param  ProviderRateLimit[]  $rateLimits
     31â–•      */
     32â–•     public static function make(array $rateLimits = [], ?int $retryAfter = null): self
     33â–•     {
  âžœ  34â–•         return new self(rateLimits: $rateLimits, retryAfter: $retryAfter);
     35â–•     }
     36â–• }
     37â–•

      [2m+4 vendor frames [22m
  [33m5   [39m[39;1mapp/Jobs/GenerateChatTitle.php[39;22m:[39;1m36[39;22m
      [2m+22 vendor frames [22m
  [33m28  [39m[39;1mapp/Http/Controllers/ChatController.php[39;22m:[39;1m260[39;22m

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ConcurrencyTest[22m [90m>[39m concurrent chat creation dâ€¦ [41;1m Error [49;22m  
[39;1m  Call to undefined method Symfony\Component\HttpFoundation\StreamedResponse::status()[39;22m

  at [32mtests/Feature/ConcurrencyTest.php[39m:[32m45[39m
     41â–• 
     42â–•     /**
     43â–•      * Count successful responses
     44â–•      */
  âžœ  45â–•     $successCount = collect($responses)->filter(fn ($r) => $r->status() === 200)->count();
     46â–•     $rateLimitedCount = collect($responses)->filter(fn ($r) => $r->status() === 429)->count();
     47â–• 
     48â–•     /**
     49â–•      * Some should succeed within rate limit

      [2m+2 vendor frames [22m
  [33m3   [39m[39;1mtests/Feature/ConcurrencyTest.php[39;22m:[39;1m45[39;22m

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ConcurrencyTest[22m [90m>[39m concurrent requests correcâ€¦ [41;1m Error [49;22m  
[39;1m  Call to undefined method Symfony\Component\HttpFoundation\StreamedResponse::status()[39;22m

  at [32mtests/Feature/ConcurrencyTest.php[39m:[32m131[39m
    127â–• 
    128â–•     /**
    129â–•      * Count successful responses
    130â–•      */
  âžœ 131â–•     $successCount = collect($responses)->filter(fn ($r) => $r->status() === 200)->count();
    132â–• 
    133â–•     /**
    134â–•      * Verify usage records match successful requests
    135â–•      */

      [2m+2 vendor frames [22m
  [33m3   [39m[39;1mtests/Feature/ConcurrencyTest.php[39;22m:[39;1m131[39;22m

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ConcurrencyTest[22m [90m>[39m concurrent quota checks prâ€¦ [41;1m Error [49;22m  
[39;1m  Call to undefined method Symfony\Component\HttpFoundation\StreamedResponse::status()[39;22m

  at [32mtests/Feature/ConcurrencyTest.php[39m:[32m173[39m
    169â–• 
    170â–•     /**
    171â–•      * Count successful and blocked responses
    172â–•      */
  âžœ 173â–•     $successCount = collect($responses)->filter(fn ($r) => $r->status() === 200)->count();
    174â–•     $blockedCount = collect($responses)->filter(fn ($r) => $r->status() === 403)->count();
    175â–• 
    176â–•     /**
    177â–•      * Should not exceed daily limit

      [2m+2 vendor frames [22m
  [33m3   [39m[39;1mtests/Feature/ConcurrencyTest.php[39;22m:[39;1m173[39;22m

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ConcurrencyTest[22m [90m>[39m multiple users can createâ€¦  [41;1m Error [49;22m  
[39;1m  Call to undefined method Symfony\Component\HttpFoundation\StreamedResponse::status()[39;22m

  at [32mtests/Feature/ConcurrencyTest.php[39m:[32m299[39m
    295â–• 
    296â–•     /**
    297â–•      * All should succeed (no interference between users)
    298â–•      */
  âžœ 299â–•     $successCount = collect($responses)->filter(fn ($r) => $r->status() === 200)->count();
    300â–•     expect($successCount)->toBe(count($users));
    301â–• 
    302â–•     /**
    303â–•      * Each user should have exactly 1 chat

      [2m+2 vendor frames [22m
  [33m3   [39m[39;1mtests/Feature/ConcurrencyTest.php[39;22m:[39;1m299[39;22m

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ConcurrencyTest[22m [90m>[39m concurrent searchâ€¦ [41;1m ErrorException [49;22m  
[39;1m  Undefined array key "chats"[39;22m

  at [32mtests/Feature/ConcurrencyTest.php[39m:[32m372[39m
    368â–•      */
    369â–•     $results1 = $response1->json();
    370â–•     $results2 = $response2->json();
    371â–• 
  âžœ 372â–•     expect($results1['chats'])->toHaveCount(1);
    373â–•     expect($results2['chats'])->toHaveCount(1);
    374â–• 
    375â–•     expect($results1['chats'][0]['title'])->toBe('User1 Laravel');
    376â–•     expect($results2['chats'][0]['title'])->toBe('User2 Laravel');

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\SecurityTest[22m [90m>[39m chat promâ€¦ [41;1m PrismRateLimitedException [49;22m  
[39;1m  You hit a provider rate limit. Details: [][39;22m

  at [32mvendor/prism-php/prism/src/Exceptions/PrismRateLimitedException.php[39m:[32m34[39m
     30â–•      * @param  ProviderRateLimit[]  $rateLimits
     31â–•      */
     32â–•     public static function make(array $rateLimits = [], ?int $retryAfter = null): self
     33â–•     {
  âžœ  34â–•         return new self(rateLimits: $rateLimits, retryAfter: $retryAfter);
     35â–•     }
     36â–• }
     37â–•

      [2m+4 vendor frames [22m
  [33m5   [39m[39;1mapp/Jobs/GenerateChatTitle.php[39;22m:[39;1m36[39;22m
      [2m+22 vendor frames [22m
  [33m28  [39m[39;1mapp/Http/Controllers/ChatController.php[39;22m:[39;1m260[39;22m

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\SecurityTest[22m [90m>[39m search query sanitizâ€¦ [41;1m ErrorException [49;22m  
[39;1m  Undefined array key "chats"[39;22m

  at [32mtests/Feature/SecurityTest.php[39m:[32m74[39m
     70â–• 
     71â–•     /**
     72â–•      * Should return 0 results because no titles contain literal "%"
     73â–•      */
  âžœ  74â–•     expect($results['chats'])->toHaveCount(0);
     75â–• });
     76â–• 
     77â–• test('search query sanitizes underscore wildcard', function () {
     78â–•     $user = User::factory()->create();

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\SecurityTest[22m [90m>[39m search query sanitizâ€¦ [41;1m ErrorException [49;22m  
[39;1m  Undefined array key "chats"[39;22m

  at [32mtests/Feature/SecurityTest.php[39m:[32m92[39m
     88â–• 
     89â–•     /**
     90â–•      * Should return 0 because no content has literal "P_P"
     91â–•      */
  âžœ  92â–•     expect($results['chats'])->toHaveCount(0);
     93â–• });
     94â–• 
     95â–• /*
     96â–• |--------------------------------------------------------------------------

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ChatModelSelectionTest[22m [90m>[39mâ€¦ [41;1m PrismRateLimitedException [49;22m  
[39;1m  You hit a provider rate limit. Details: [][39;22m

  at [32mvendor/prism-php/prism/src/Exceptions/PrismRateLimitedException.php[39m:[32m34[39m
     30â–•      * @param  ProviderRateLimit[]  $rateLimits
     31â–•      */
     32â–•     public static function make(array $rateLimits = [], ?int $retryAfter = null): self
     33â–•     {
  âžœ  34â–•         return new self(rateLimits: $rateLimits, retryAfter: $retryAfter);
     35â–•     }
     36â–• }
     37â–•

      [2m+4 vendor frames [22m
  [33m5   [39m[39;1mapp/Jobs/GenerateChatTitle.php[39;22m:[39;1m36[39;22m
      [2m+22 vendor frames [22m
  [33m28  [39m[39;1mapp/Http/Controllers/ChatController.php[39;22m:[39;1m260[39;22m

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ChatRequestValidationTest[22m [90m>[39m chat request validatesâ€¦    
[39;1m  Expected response status code [422] but received 403.
Failed asserting that 403 is identical to 422.[39;22m

  at [32mtests/Feature/ChatRequestValidationTest.php[39m:[32m74[39m
     70â–•         'chat_id' => 99999, // Non-existent
     71â–•         'model' => 'gemini-2.5-flash-lite',
     72â–•     ]);
     73â–• 
  âžœ  74â–•     $response->assertStatus(422);
     75â–•     $response->assertJsonValidationErrors(['chat_id']);
     76â–• });
     77â–• 
     78â–• test('chat request accepts valid chat_id', function () {

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ChatRequestValidationTest[22m [90m>[39m chat request validatesâ€¦    
[39;1m  Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.

The following exception occurred during the last request:

InvalidArgumentException: /tmp/php2jtu4040u35efFEifCO is empty in /home/shure/Documents/cassette/web/webai/vendor/prism-php/prism/src/ValueObjects/Media/Media.php:58
Stack trace:
#0 /home/shure/Documents/cassette/web/webai/app/Http/Controllers/ChatController.php(110): Prism\Prism\ValueObjects\Media\Media::fromLocalPath('/tmp/php2jtu404...', 'image/jpeg')
#1 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(46): App\Http\Controllers\ChatController->stream(Object(App\Http\Requests\ChatRequest))
#2 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Route.php(265): Illuminate\Routing\ControllerDispatcher->dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\ChatController), 'stream')
#3 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Route.php(211): Illuminate\Routing\Route->runController()
#4 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(822): Illuminate\Routing\Route->run()
#5 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(180): Illuminate\Routing\Router->{closure:Illuminate\Routing\Router::runRouteWithinStack():821}(Object(Illuminate\Http\Request))
#6 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Auth/Middleware/EnsureEmailIsVerified.php(41): Illuminate\Pipeline\Pipeline->{closure:Illuminate\Pipeline\Pipeline::prepareDestination():178}(Object(Illuminate\Http\Request))
#7 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Auth\Middleware\EnsureEmailIsVerified->handle(Object(Illuminate\Http\Request), Object(Closure))
#8 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/AddLinkHeadersForPreloadedAssets.php(32): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#9 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\AddLinkHeadersForPreloadedAssets->handle(Object(Illuminate\Http\Request), Object(Closure))
#10 /home/shure/Documents/cassette/web/webai/vendor/inertiajs/inertia-laravel/src/Middleware.php(122): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#11 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Inertia\Middleware->handle(Object(Illuminate\Http\Request), Object(Closure))
#12 /home/shure/Documents/cassette/web/webai/app/Http/Middleware/HandleAppearance.php(21): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#13 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): App\Http\Middleware\HandleAppearance->handle(Object(Illuminate\Http\Request), Object(Closure))
#14 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#15 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Routing\Middleware\SubstituteBindings->handle(Object(Illuminate\Http\Request), Object(Closure))
#16 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Middleware/ThrottleRequests.php(166): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#17 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Middleware/ThrottleRequests.php(129): Illuminate\Routing\Middleware\ThrottleRequests->handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#18 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Middleware/ThrottleRequests.php(90): Illuminate\Routing\Middleware\ThrottleRequests->handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'chat-messages', Object(Closure))
#19 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Routing\Middleware\ThrottleRequests->handle(Object(Illuminate\Http\Request), Object(Closure), 'chat-messages')
#20 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(63): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#21 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Auth\Middleware\Authenticate->handle(Object(Illuminate\Http\Request), Object(Closure))
#22 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(87): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#23 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle(Object(Illuminate\Http\Request), Object(Closure))
#24 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(48): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#25 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\View\Middleware\ShareErrorsFromSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#26 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(120): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#27 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(63): Illuminate\Session\Middleware\StartSession->handleStatefulRequest(Object(Illuminate\Http\Request), Object(Illuminate\Session\Store), Object(Closure))
#28 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Session\Middleware\StartSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#29 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(36): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#30 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle(Object(Illuminate\Http\Request), Object(Closure))
#31 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(74): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#32 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Cookie\Middleware\EncryptCookies->handle(Object(Illuminate\Http\Request), Object(Closure))
#33 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(137): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#34 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(821): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#35 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(800): Illuminate\Routing\Router->runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#36 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(764): Illuminate\Routing\Router->runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#37 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(753): Illuminate\Routing\Router->dispatchToRoute(Object(Illuminate\Http\Request))
#38 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router->dispatch(Object(Illuminate\Http\Request))
#39 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(180): Illuminate\Foundation\Http\Kernel->{closure:Illuminate\Foundation\Http\Kernel::dispatchToRouter():197}(Object(Illuminate\Http\Request))
#40 /home/shure/Documents/cassette/web/webai/vendor/livewire/livewire/src/Features/SupportDisablingBackButtonCache/DisableBackButtonCacheMiddleware.php(19): Illuminate\Pipeline\Pipeline->{closure:Illuminate\Pipeline\Pipeline::prepareDestination():178}(Object(Illuminate\Http\Request))
#41 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Livewire\Features\SupportDisablingBackButtonCache\DisableBackButtonCacheMiddleware->handle(Object(Illuminate\Http\Request), Object(Closure))
#42 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#43 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#44 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle(Object(Illuminate\Http\Request), Object(Closure))
#45 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#46 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#47 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\TrimStrings->handle(Object(Illuminate\Http\Request), Object(Closure))
#48 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#49 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\ValidatePostSize->handle(Object(Illuminate\Http\Request), Object(Closure))
#50 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(109): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#51 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle(Object(Illuminate\Http\Request), Object(Closure))
#52 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(48): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#53 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\HandleCors->handle(Object(Illuminate\Http\Request), Object(Closure))
#54 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#55 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\TrustProxies->handle(Object(Illuminate\Http\Request), Object(Closure))
#56 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#57 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle(Object(Illuminate\Http\Request), Object(Closure))
#58 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePathEncoding.php(26): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#59 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\ValidatePathEncoding->handle(Object(Illuminate\Http\Request), Object(Closure))
#60 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(137): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#61 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#62 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter(Object(Illuminate\Http\Request))
#63 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle(Object(Illuminate\Http\Request))
#64 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase->call('POST', '/chat/stream', Array, Array, Array, Array, '{"prompt":"Anal...')
#65 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase->json('POST', '/chat/stream', Array, Array, 0)
#66 /home/shure/Documents/cassette/web/webai/tests/Feature/ChatRequestValidationTest.php(103): Illuminate\Foundation\Testing\TestCase->postJson('/chat/stream', Array)
#67 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Factories/TestCaseMethodFactory.php(168): P\Tests\Feature\ChatRequestValidationTest->{closure:/home/shure/Documents/cassette/web/webai/tests/Feature/ChatRequestValidationTest.php:100}('jpg', 'image/jpeg', true)
#68 [internal function]: P\Tests\Feature\ChatRequestValidationTest->{closure:Pest\Factories\TestCaseMethodFactory::getClosure():158}('jpg', 'image/jpeg', true)
#69 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Concerns/Testable.php(429): call_user_func_array(Object(Closure), Array)
#70 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Support/ExceptionTrace.php(26): P\Tests\Feature\ChatRequestValidationTest->{closure:Pest\Concerns\Testable::__callClosure():429}()
#71 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Concerns/Testable.php(429): Pest\Support\ExceptionTrace::ensure(Object(Closure))
#72 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Concerns/Testable.php(331): P\Tests\Feature\ChatRequestValidationTest->__callClosure(Object(Closure), Array)
#73 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Factories/TestCaseFactory.php(169) : eval()'d code(87): P\Tests\Feature\ChatRequestValidationTest->__runTest(Object(Closure), 'jpg', 'image/jpeg', true)
#74 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestCase.php(1326): P\Tests\Feature\ChatRequestValidationTest->__pest_evaluable_chat_request_validates_file_mime_types('jpg', 'image/jpeg', true)
#75 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestCase.php(519): PHPUnit\Framework\TestCase->runTest()
#76 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(99): PHPUnit\Framework\TestCase->runBare()
#77 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestCase.php(359): PHPUnit\Framework\TestRunner->run(Object(P\Tests\Feature\ChatRequestValidationTest))
#78 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestSuite.php(374): PHPUnit\Framework\TestCase->run()
#79 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestSuite.php(374): PHPUnit\Framework\TestSuite->run()
#80 /home/shure/Documents/cassette/web/webai/vendor/brianium/paratest/src/WrapperRunner/ApplicationForWrapperWorker.php(119): PHPUnit\Framework\TestSuite->run()
#81 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/bin/worker.php(105): ParaTest\WrapperRunner\ApplicationForWrapperWorker->runTest('/home/shure/Doc...')
#82 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/bin/worker.php(110): {closure:/home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/bin/worker.php:30}()
#83 {main}

----------------------------------------------------------------------------------

/tmp/php2jtu4040u35efFEifCO is empty[39;22m

  at [32mtests/Feature/ChatRequestValidationTest.php[39m:[32m109[39m
    105â–•         'files' => [$file],
    106â–•     ]);
    107â–• 
    108â–•     if ($shouldPass) {
  âžœ 109â–•         $response->assertOk();
    110â–•     } else {
    111â–•         $response->assertStatus(422);
    112â–•         $response->assertJsonValidationErrors(['files.0']);
    113â–•     }

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ChatRequestValidationTest[22m [90m>[39m chat request validatesâ€¦    
[39;1m  Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.

The following exception occurred during the last request:

InvalidArgumentException: /tmp/phpocv9rkibc1iifLApGbb is empty in /home/shure/Documents/cassette/web/webai/vendor/prism-php/prism/src/ValueObjects/Media/Media.php:58
Stack trace:
#0 /home/shure/Documents/cassette/web/webai/app/Http/Controllers/ChatController.php(110): Prism\Prism\ValueObjects\Media\Media::fromLocalPath('/tmp/phpocv9rki...', 'image/png')
#1 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(46): App\Http\Controllers\ChatController->stream(Object(App\Http\Requests\ChatRequest))
#2 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Route.php(265): Illuminate\Routing\ControllerDispatcher->dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\ChatController), 'stream')
#3 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Route.php(211): Illuminate\Routing\Route->runController()
#4 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(822): Illuminate\Routing\Route->run()
#5 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(180): Illuminate\Routing\Router->{closure:Illuminate\Routing\Router::runRouteWithinStack():821}(Object(Illuminate\Http\Request))
#6 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Auth/Middleware/EnsureEmailIsVerified.php(41): Illuminate\Pipeline\Pipeline->{closure:Illuminate\Pipeline\Pipeline::prepareDestination():178}(Object(Illuminate\Http\Request))
#7 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Auth\Middleware\EnsureEmailIsVerified->handle(Object(Illuminate\Http\Request), Object(Closure))
#8 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/AddLinkHeadersForPreloadedAssets.php(32): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#9 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\AddLinkHeadersForPreloadedAssets->handle(Object(Illuminate\Http\Request), Object(Closure))
#10 /home/shure/Documents/cassette/web/webai/vendor/inertiajs/inertia-laravel/src/Middleware.php(122): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#11 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Inertia\Middleware->handle(Object(Illuminate\Http\Request), Object(Closure))
#12 /home/shure/Documents/cassette/web/webai/app/Http/Middleware/HandleAppearance.php(21): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#13 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): App\Http\Middleware\HandleAppearance->handle(Object(Illuminate\Http\Request), Object(Closure))
#14 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#15 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Routing\Middleware\SubstituteBindings->handle(Object(Illuminate\Http\Request), Object(Closure))
#16 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Middleware/ThrottleRequests.php(166): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#17 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Middleware/ThrottleRequests.php(129): Illuminate\Routing\Middleware\ThrottleRequests->handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#18 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Middleware/ThrottleRequests.php(90): Illuminate\Routing\Middleware\ThrottleRequests->handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'chat-messages', Object(Closure))
#19 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Routing\Middleware\ThrottleRequests->handle(Object(Illuminate\Http\Request), Object(Closure), 'chat-messages')
#20 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(63): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#21 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Auth\Middleware\Authenticate->handle(Object(Illuminate\Http\Request), Object(Closure))
#22 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(87): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#23 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle(Object(Illuminate\Http\Request), Object(Closure))
#24 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(48): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#25 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\View\Middleware\ShareErrorsFromSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#26 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(120): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#27 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(63): Illuminate\Session\Middleware\StartSession->handleStatefulRequest(Object(Illuminate\Http\Request), Object(Illuminate\Session\Store), Object(Closure))
#28 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Session\Middleware\StartSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#29 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(36): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#30 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle(Object(Illuminate\Http\Request), Object(Closure))
#31 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(74): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#32 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Cookie\Middleware\EncryptCookies->handle(Object(Illuminate\Http\Request), Object(Closure))
#33 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(137): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#34 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(821): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#35 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(800): Illuminate\Routing\Router->runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#36 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(764): Illuminate\Routing\Router->runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#37 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(753): Illuminate\Routing\Router->dispatchToRoute(Object(Illuminate\Http\Request))
#38 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router->dispatch(Object(Illuminate\Http\Request))
#39 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(180): Illuminate\Foundation\Http\Kernel->{closure:Illuminate\Foundation\Http\Kernel::dispatchToRouter():197}(Object(Illuminate\Http\Request))
#40 /home/shure/Documents/cassette/web/webai/vendor/livewire/livewire/src/Features/SupportDisablingBackButtonCache/DisableBackButtonCacheMiddleware.php(19): Illuminate\Pipeline\Pipeline->{closure:Illuminate\Pipeline\Pipeline::prepareDestination():178}(Object(Illuminate\Http\Request))
#41 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Livewire\Features\SupportDisablingBackButtonCache\DisableBackButtonCacheMiddleware->handle(Object(Illuminate\Http\Request), Object(Closure))
#42 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#43 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#44 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle(Object(Illuminate\Http\Request), Object(Closure))
#45 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#46 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#47 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\TrimStrings->handle(Object(Illuminate\Http\Request), Object(Closure))
#48 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#49 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\ValidatePostSize->handle(Object(Illuminate\Http\Request), Object(Closure))
#50 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(109): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#51 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle(Object(Illuminate\Http\Request), Object(Closure))
#52 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(48): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#53 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\HandleCors->handle(Object(Illuminate\Http\Request), Object(Closure))
#54 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#55 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\TrustProxies->handle(Object(Illuminate\Http\Request), Object(Closure))
#56 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#57 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle(Object(Illuminate\Http\Request), Object(Closure))
#58 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePathEncoding.php(26): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#59 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\ValidatePathEncoding->handle(Object(Illuminate\Http\Request), Object(Closure))
#60 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(137): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#61 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#62 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter(Object(Illuminate\Http\Request))
#63 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle(Object(Illuminate\Http\Request))
#64 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase->call('POST', '/chat/stream', Array, Array, Array, Array, '{"prompt":"Anal...')
#65 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase->json('POST', '/chat/stream', Array, Array, 0)
#66 /home/shure/Documents/cassette/web/webai/tests/Feature/ChatRequestValidationTest.php(103): Illuminate\Foundation\Testing\TestCase->postJson('/chat/stream', Array)
#67 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Factories/TestCaseMethodFactory.php(168): P\Tests\Feature\ChatRequestValidationTest->{closure:/home/shure/Documents/cassette/web/webai/tests/Feature/ChatRequestValidationTest.php:100}('png', 'image/png', true)
#68 [internal function]: P\Tests\Feature\ChatRequestValidationTest->{closure:Pest\Factories\TestCaseMethodFactory::getClosure():158}('png', 'image/png', true)
#69 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Concerns/Testable.php(429): call_user_func_array(Object(Closure), Array)
#70 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Support/ExceptionTrace.php(26): P\Tests\Feature\ChatRequestValidationTest->{closure:Pest\Concerns\Testable::__callClosure():429}()
#71 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Concerns/Testable.php(429): Pest\Support\ExceptionTrace::ensure(Object(Closure))
#72 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Concerns/Testable.php(331): P\Tests\Feature\ChatRequestValidationTest->__callClosure(Object(Closure), Array)
#73 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Factories/TestCaseFactory.php(169) : eval()'d code(87): P\Tests\Feature\ChatRequestValidationTest->__runTest(Object(Closure), 'png', 'image/png', true)
#74 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestCase.php(1326): P\Tests\Feature\ChatRequestValidationTest->__pest_evaluable_chat_request_validates_file_mime_types('png', 'image/png', true)
#75 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestCase.php(519): PHPUnit\Framework\TestCase->runTest()
#76 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(99): PHPUnit\Framework\TestCase->runBare()
#77 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestCase.php(359): PHPUnit\Framework\TestRunner->run(Object(P\Tests\Feature\ChatRequestValidationTest))
#78 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestSuite.php(374): PHPUnit\Framework\TestCase->run()
#79 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestSuite.php(374): PHPUnit\Framework\TestSuite->run()
#80 /home/shure/Documents/cassette/web/webai/vendor/brianium/paratest/src/WrapperRunner/ApplicationForWrapperWorker.php(119): PHPUnit\Framework\TestSuite->run()
#81 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/bin/worker.php(105): ParaTest\WrapperRunner\ApplicationForWrapperWorker->runTest('/home/shure/Doc...')
#82 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/bin/worker.php(110): {closure:/home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/bin/worker.php:30}()
#83 {main}

----------------------------------------------------------------------------------

/tmp/phpocv9rkibc1iifLApGbb is empty[39;22m

  at [32mtests/Feature/ChatRequestValidationTest.php[39m:[32m109[39m
    105â–•         'files' => [$file],
    106â–•     ]);
    107â–• 
    108â–•     if ($shouldPass) {
  âžœ 109â–•         $response->assertOk();
    110â–•     } else {
    111â–•         $response->assertStatus(422);
    112â–•         $response->assertJsonValidationErrors(['files.0']);
    113â–•     }

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ChatRequestValidationTest[22m [90m>[39m chat request validatesâ€¦    
[39;1m  Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.

The following exception occurred during the last request:

InvalidArgumentException: /tmp/phphq7u6d3c0het4nLmNEe is empty in /home/shure/Documents/cassette/web/webai/vendor/prism-php/prism/src/ValueObjects/Media/Media.php:58
Stack trace:
#0 /home/shure/Documents/cassette/web/webai/app/Http/Controllers/ChatController.php(110): Prism\Prism\ValueObjects\Media\Media::fromLocalPath('/tmp/phphq7u6d3...', 'image/gif')
#1 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(46): App\Http\Controllers\ChatController->stream(Object(App\Http\Requests\ChatRequest))
#2 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Route.php(265): Illuminate\Routing\ControllerDispatcher->dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\ChatController), 'stream')
#3 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Route.php(211): Illuminate\Routing\Route->runController()
#4 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(822): Illuminate\Routing\Route->run()
#5 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(180): Illuminate\Routing\Router->{closure:Illuminate\Routing\Router::runRouteWithinStack():821}(Object(Illuminate\Http\Request))
#6 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Auth/Middleware/EnsureEmailIsVerified.php(41): Illuminate\Pipeline\Pipeline->{closure:Illuminate\Pipeline\Pipeline::prepareDestination():178}(Object(Illuminate\Http\Request))
#7 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Auth\Middleware\EnsureEmailIsVerified->handle(Object(Illuminate\Http\Request), Object(Closure))
#8 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/AddLinkHeadersForPreloadedAssets.php(32): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#9 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\AddLinkHeadersForPreloadedAssets->handle(Object(Illuminate\Http\Request), Object(Closure))
#10 /home/shure/Documents/cassette/web/webai/vendor/inertiajs/inertia-laravel/src/Middleware.php(122): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#11 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Inertia\Middleware->handle(Object(Illuminate\Http\Request), Object(Closure))
#12 /home/shure/Documents/cassette/web/webai/app/Http/Middleware/HandleAppearance.php(21): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#13 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): App\Http\Middleware\HandleAppearance->handle(Object(Illuminate\Http\Request), Object(Closure))
#14 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#15 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Routing\Middleware\SubstituteBindings->handle(Object(Illuminate\Http\Request), Object(Closure))
#16 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Middleware/ThrottleRequests.php(166): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#17 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Middleware/ThrottleRequests.php(129): Illuminate\Routing\Middleware\ThrottleRequests->handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#18 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Middleware/ThrottleRequests.php(90): Illuminate\Routing\Middleware\ThrottleRequests->handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'chat-messages', Object(Closure))
#19 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Routing\Middleware\ThrottleRequests->handle(Object(Illuminate\Http\Request), Object(Closure), 'chat-messages')
#20 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(63): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#21 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Auth\Middleware\Authenticate->handle(Object(Illuminate\Http\Request), Object(Closure))
#22 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(87): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#23 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle(Object(Illuminate\Http\Request), Object(Closure))
#24 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(48): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#25 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\View\Middleware\ShareErrorsFromSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#26 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(120): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#27 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(63): Illuminate\Session\Middleware\StartSession->handleStatefulRequest(Object(Illuminate\Http\Request), Object(Illuminate\Session\Store), Object(Closure))
#28 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Session\Middleware\StartSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#29 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(36): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#30 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle(Object(Illuminate\Http\Request), Object(Closure))
#31 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(74): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#32 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Cookie\Middleware\EncryptCookies->handle(Object(Illuminate\Http\Request), Object(Closure))
#33 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(137): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#34 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(821): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#35 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(800): Illuminate\Routing\Router->runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#36 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(764): Illuminate\Routing\Router->runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#37 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(753): Illuminate\Routing\Router->dispatchToRoute(Object(Illuminate\Http\Request))
#38 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router->dispatch(Object(Illuminate\Http\Request))
#39 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(180): Illuminate\Foundation\Http\Kernel->{closure:Illuminate\Foundation\Http\Kernel::dispatchToRouter():197}(Object(Illuminate\Http\Request))
#40 /home/shure/Documents/cassette/web/webai/vendor/livewire/livewire/src/Features/SupportDisablingBackButtonCache/DisableBackButtonCacheMiddleware.php(19): Illuminate\Pipeline\Pipeline->{closure:Illuminate\Pipeline\Pipeline::prepareDestination():178}(Object(Illuminate\Http\Request))
#41 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Livewire\Features\SupportDisablingBackButtonCache\DisableBackButtonCacheMiddleware->handle(Object(Illuminate\Http\Request), Object(Closure))
#42 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#43 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#44 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle(Object(Illuminate\Http\Request), Object(Closure))
#45 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#46 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#47 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\TrimStrings->handle(Object(Illuminate\Http\Request), Object(Closure))
#48 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#49 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\ValidatePostSize->handle(Object(Illuminate\Http\Request), Object(Closure))
#50 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(109): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#51 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle(Object(Illuminate\Http\Request), Object(Closure))
#52 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(48): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#53 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\HandleCors->handle(Object(Illuminate\Http\Request), Object(Closure))
#54 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#55 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\TrustProxies->handle(Object(Illuminate\Http\Request), Object(Closure))
#56 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#57 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle(Object(Illuminate\Http\Request), Object(Closure))
#58 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePathEncoding.php(26): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#59 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\ValidatePathEncoding->handle(Object(Illuminate\Http\Request), Object(Closure))
#60 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(137): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#61 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#62 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter(Object(Illuminate\Http\Request))
#63 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle(Object(Illuminate\Http\Request))
#64 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase->call('POST', '/chat/stream', Array, Array, Array, Array, '{"prompt":"Anal...')
#65 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase->json('POST', '/chat/stream', Array, Array, 0)
#66 /home/shure/Documents/cassette/web/webai/tests/Feature/ChatRequestValidationTest.php(103): Illuminate\Foundation\Testing\TestCase->postJson('/chat/stream', Array)
#67 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Factories/TestCaseMethodFactory.php(168): P\Tests\Feature\ChatRequestValidationTest->{closure:/home/shure/Documents/cassette/web/webai/tests/Feature/ChatRequestValidationTest.php:100}('gif', 'image/gif', true)
#68 [internal function]: P\Tests\Feature\ChatRequestValidationTest->{closure:Pest\Factories\TestCaseMethodFactory::getClosure():158}('gif', 'image/gif', true)
#69 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Concerns/Testable.php(429): call_user_func_array(Object(Closure), Array)
#70 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Support/ExceptionTrace.php(26): P\Tests\Feature\ChatRequestValidationTest->{closure:Pest\Concerns\Testable::__callClosure():429}()
#71 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Concerns/Testable.php(429): Pest\Support\ExceptionTrace::ensure(Object(Closure))
#72 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Concerns/Testable.php(331): P\Tests\Feature\ChatRequestValidationTest->__callClosure(Object(Closure), Array)
#73 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Factories/TestCaseFactory.php(169) : eval()'d code(87): P\Tests\Feature\ChatRequestValidationTest->__runTest(Object(Closure), 'gif', 'image/gif', true)
#74 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestCase.php(1326): P\Tests\Feature\ChatRequestValidationTest->__pest_evaluable_chat_request_validates_file_mime_types('gif', 'image/gif', true)
#75 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestCase.php(519): PHPUnit\Framework\TestCase->runTest()
#76 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(99): PHPUnit\Framework\TestCase->runBare()
#77 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestCase.php(359): PHPUnit\Framework\TestRunner->run(Object(P\Tests\Feature\ChatRequestValidationTest))
#78 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestSuite.php(374): PHPUnit\Framework\TestCase->run()
#79 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestSuite.php(374): PHPUnit\Framework\TestSuite->run()
#80 /home/shure/Documents/cassette/web/webai/vendor/brianium/paratest/src/WrapperRunner/ApplicationForWrapperWorker.php(119): PHPUnit\Framework\TestSuite->run()
#81 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/bin/worker.php(105): ParaTest\WrapperRunner\ApplicationForWrapperWorker->runTest('/home/shure/Doc...')
#82 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/bin/worker.php(110): {closure:/home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/bin/worker.php:30}()
#83 {main}

----------------------------------------------------------------------------------

/tmp/phphq7u6d3c0het4nLmNEe is empty[39;22m

  at [32mtests/Feature/ChatRequestValidationTest.php[39m:[32m109[39m
    105â–•         'files' => [$file],
    106â–•     ]);
    107â–• 
    108â–•     if ($shouldPass) {
  âžœ 109â–•         $response->assertOk();
    110â–•     } else {
    111â–•         $response->assertStatus(422);
    112â–•         $response->assertJsonValidationErrors(['files.0']);
    113â–•     }

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ChatRequestValidationTest[22m [90m>[39m chat request accepts fiâ€¦   
[39;1m  Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.

The following exception occurred during the last request:

InvalidArgumentException: /tmp/phpnad8jpldq36rfBJkMaH is empty in /home/shure/Documents/cassette/web/webai/vendor/prism-php/prism/src/ValueObjects/Media/Media.php:58
Stack trace:
#0 /home/shure/Documents/cassette/web/webai/app/Http/Controllers/ChatController.php(110): Prism\Prism\ValueObjects\Media\Media::fromLocalPath('/tmp/phpnad8jpl...', 'image/jpeg')
#1 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(46): App\Http\Controllers\ChatController->stream(Object(App\Http\Requests\ChatRequest))
#2 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Route.php(265): Illuminate\Routing\ControllerDispatcher->dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\ChatController), 'stream')
#3 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Route.php(211): Illuminate\Routing\Route->runController()
#4 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(822): Illuminate\Routing\Route->run()
#5 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(180): Illuminate\Routing\Router->{closure:Illuminate\Routing\Router::runRouteWithinStack():821}(Object(Illuminate\Http\Request))
#6 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Auth/Middleware/EnsureEmailIsVerified.php(41): Illuminate\Pipeline\Pipeline->{closure:Illuminate\Pipeline\Pipeline::prepareDestination():178}(Object(Illuminate\Http\Request))
#7 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Auth\Middleware\EnsureEmailIsVerified->handle(Object(Illuminate\Http\Request), Object(Closure))
#8 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/AddLinkHeadersForPreloadedAssets.php(32): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#9 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\AddLinkHeadersForPreloadedAssets->handle(Object(Illuminate\Http\Request), Object(Closure))
#10 /home/shure/Documents/cassette/web/webai/vendor/inertiajs/inertia-laravel/src/Middleware.php(122): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#11 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Inertia\Middleware->handle(Object(Illuminate\Http\Request), Object(Closure))
#12 /home/shure/Documents/cassette/web/webai/app/Http/Middleware/HandleAppearance.php(21): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#13 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): App\Http\Middleware\HandleAppearance->handle(Object(Illuminate\Http\Request), Object(Closure))
#14 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#15 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Routing\Middleware\SubstituteBindings->handle(Object(Illuminate\Http\Request), Object(Closure))
#16 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Middleware/ThrottleRequests.php(166): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#17 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Middleware/ThrottleRequests.php(129): Illuminate\Routing\Middleware\ThrottleRequests->handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#18 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Middleware/ThrottleRequests.php(90): Illuminate\Routing\Middleware\ThrottleRequests->handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'chat-messages', Object(Closure))
#19 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Routing\Middleware\ThrottleRequests->handle(Object(Illuminate\Http\Request), Object(Closure), 'chat-messages')
#20 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(63): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#21 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Auth\Middleware\Authenticate->handle(Object(Illuminate\Http\Request), Object(Closure))
#22 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(87): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#23 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle(Object(Illuminate\Http\Request), Object(Closure))
#24 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(48): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#25 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\View\Middleware\ShareErrorsFromSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#26 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(120): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#27 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(63): Illuminate\Session\Middleware\StartSession->handleStatefulRequest(Object(Illuminate\Http\Request), Object(Illuminate\Session\Store), Object(Closure))
#28 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Session\Middleware\StartSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#29 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(36): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#30 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle(Object(Illuminate\Http\Request), Object(Closure))
#31 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(74): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#32 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Cookie\Middleware\EncryptCookies->handle(Object(Illuminate\Http\Request), Object(Closure))
#33 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(137): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#34 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(821): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#35 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(800): Illuminate\Routing\Router->runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#36 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(764): Illuminate\Routing\Router->runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#37 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Routing/Router.php(753): Illuminate\Routing\Router->dispatchToRoute(Object(Illuminate\Http\Request))
#38 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router->dispatch(Object(Illuminate\Http\Request))
#39 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(180): Illuminate\Foundation\Http\Kernel->{closure:Illuminate\Foundation\Http\Kernel::dispatchToRouter():197}(Object(Illuminate\Http\Request))
#40 /home/shure/Documents/cassette/web/webai/vendor/livewire/livewire/src/Features/SupportDisablingBackButtonCache/DisableBackButtonCacheMiddleware.php(19): Illuminate\Pipeline\Pipeline->{closure:Illuminate\Pipeline\Pipeline::prepareDestination():178}(Object(Illuminate\Http\Request))
#41 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Livewire\Features\SupportDisablingBackButtonCache\DisableBackButtonCacheMiddleware->handle(Object(Illuminate\Http\Request), Object(Closure))
#42 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#43 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#44 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle(Object(Illuminate\Http\Request), Object(Closure))
#45 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#46 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#47 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\TrimStrings->handle(Object(Illuminate\Http\Request), Object(Closure))
#48 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#49 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\ValidatePostSize->handle(Object(Illuminate\Http\Request), Object(Closure))
#50 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(109): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#51 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle(Object(Illuminate\Http\Request), Object(Closure))
#52 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(48): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#53 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\HandleCors->handle(Object(Illuminate\Http\Request), Object(Closure))
#54 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#55 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\TrustProxies->handle(Object(Illuminate\Http\Request), Object(Closure))
#56 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#57 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle(Object(Illuminate\Http\Request), Object(Closure))
#58 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePathEncoding.php(26): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#59 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\ValidatePathEncoding->handle(Object(Illuminate\Http\Request), Object(Closure))
#60 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(137): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}(Object(Illuminate\Http\Request))
#61 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#62 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter(Object(Illuminate\Http\Request))
#63 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle(Object(Illuminate\Http\Request))
#64 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase->call('POST', '/chat/stream', Array, Array, Array, Array, '{"prompt":"Anal...')
#65 /home/shure/Documents/cassette/web/webai/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase->json('POST', '/chat/stream', Array, Array, 0)
#66 /home/shure/Documents/cassette/web/webai/tests/Feature/ChatRequestValidationTest.php(142): Illuminate\Foundation\Testing\TestCase->postJson('/chat/stream', Array)
#67 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Factories/TestCaseMethodFactory.php(168): P\Tests\Feature\ChatRequestValidationTest->{closure:/home/shure/Documents/cassette/web/webai/tests/Feature/ChatRequestValidationTest.php:139}()
#68 [internal function]: P\Tests\Feature\ChatRequestValidationTest->{closure:Pest\Factories\TestCaseMethodFactory::getClosure():158}()
#69 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Concerns/Testable.php(429): call_user_func_array(Object(Closure), Array)
#70 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Support/ExceptionTrace.php(26): P\Tests\Feature\ChatRequestValidationTest->{closure:Pest\Concerns\Testable::__callClosure():429}()
#71 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Concerns/Testable.php(429): Pest\Support\ExceptionTrace::ensure(Object(Closure))
#72 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Concerns/Testable.php(331): P\Tests\Feature\ChatRequestValidationTest->__callClosure(Object(Closure), Array)
#73 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/src/Factories/TestCaseFactory.php(169) : eval()'d code(110): P\Tests\Feature\ChatRequestValidationTest->__runTest(Object(Closure))
#74 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestCase.php(1326): P\Tests\Feature\ChatRequestValidationTest->__pest_evaluable_chat_request_accepts_file_at_size_boundary()
#75 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestCase.php(519): PHPUnit\Framework\TestCase->runTest()
#76 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(99): PHPUnit\Framework\TestCase->runBare()
#77 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestCase.php(359): PHPUnit\Framework\TestRunner->run(Object(P\Tests\Feature\ChatRequestValidationTest))
#78 /home/shure/Documents/cassette/web/webai/vendor/phpunit/phpunit/src/Framework/TestSuite.php(374): PHPUnit\Framework\TestCase->run()
#79 /home/shure/Documents/cassette/web/webai/vendor/brianium/paratest/src/WrapperRunner/ApplicationForWrapperWorker.php(119): PHPUnit\Framework\TestSuite->run()
#80 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/bin/worker.php(105): ParaTest\WrapperRunner\ApplicationForWrapperWorker->runTest('/home/shure/Doc...')
#81 /home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/bin/worker.php(110): {closure:/home/shure/Documents/cassette/web/webai/vendor/pestphp/pest/bin/worker.php:30}()
#82 {main}

----------------------------------------------------------------------------------

/tmp/phpnad8jpldq36rfBJkMaH is empty[39;22m

  at [32mtests/Feature/ChatRequestValidationTest.php[39m:[32m147[39m
    143â–•         'prompt' => 'Analyze this file',
    144â–•         'files' => [$file],
    145â–•     ]);
    146â–• 
  âžœ 147â–•     $response->assertOk();
    148â–• });
    149â–• 
    150â–• test('chat request accepts multiple valid files', function () {
    151â–•     $files = [

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ChatRequestValidationTest[22m [90m>[39m update chat request valâ€¦   
[39;1m  Expected response status code [422] but received 302.
Failed asserting that 302 is identical to 422.[39;22m

  at [32mtests/Feature/ChatRequestValidationTest.php[39m:[32m199[39m
    195â–•     $response = $this->patchJson("/chat/{$chat->id}", [
    196â–•         'title' => str_repeat('a', 256),
    197â–•     ]);
    198â–• 
  âžœ 199â–•     $response->assertStatus(422);
    200â–•     $response->assertJsonValidationErrors(['title']);
    201â–• });
    202â–• 
    203â–• test('update chat request validates title must be string', function (mixed $invalidTitle) {

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ChatRequestValidationTest[22m [90m>[39m update chat request accâ€¦   
[39;1m  Expected response status code [200] but received 302.
Failed asserting that 302 is identical to 200.[39;22m

  at [32mtests/Feature/ChatRequestValidationTest.php[39m:[32m226[39m
    222â–•     $response = $this->patchJson("/chat/{$chat->id}", [
    223â–•         'title' => str_repeat('a', 255),
    224â–•     ]);
    225â–• 
  âžœ 226â–•     $response->assertOk();
    227â–• 
    228â–•     $chat->refresh();
    229â–•     expect($chat->title)->toHaveLength(255);
    230â–• });

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ErrorRecoveryTest[22m [90m>[39m handles missing storage directoâ€¦   
[39;1m  Failed asserting that an array contains 405.[39;22m

  at [32mtests/Feature/ErrorRecoveryTest.php[39m:[32m199[39m
    195â–• 
    196â–•     /**
    197â–•      * Should succeed or handle gracefully
    198â–•      */
  âžœ 199â–•     expect($response->getStatusCode())->toBeIn([200, 302, 500]);
    200â–• })->group('error-recovery');
    201â–• 
    202â–• /*
    203â–• |--------------------------------------------------------------------------

  [33m1   [39m[39;1mtests/Feature/ErrorRecoveryTest.php[39;22m:[39;1m199[39;22m

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ErrorRecoveryTest[22m [90m>[39m handles failed queue job gracefâ€¦   
[39;1m  The expected [App\Jobs\GenerateChatTitle] job was not pushed.
Failed asserting that false is true.[39;22m

  at [32mvendor/laravel/framework/src/Illuminate/Support/Testing/Fakes/QueueFake.php[39m:[32m111[39m
    107â–•         if (is_numeric($callback)) {
    108â–•             return $this->assertPushedTimes($job, $callback);
    109â–•         }
    110â–• 
  âžœ 111â–•         PHPUnit::assertTrue(
    112â–•             $this->pushed($job, $callback)->count() > 0,
    113â–•             "The expected [{$job}] job was not pushed."
    114â–•         );
    115â–•     }

      [2m+2 vendor frames [22m
  [33m3   [39m[39;1mtests/Feature/ErrorRecoveryTest.php[39;22m:[39;1m227[39;22m

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ErrorRecoveryTest[22m [90m>[39m retries failed jobs appropriateâ€¦   
[39;1m  The expected [App\Jobs\GenerateChatTitle] job was pushed 0 times instead of 1 time.
Failed asserting that 0 is identical to 1.[39;22m

  at [32mvendor/laravel/framework/src/Illuminate/Support/Testing/Fakes/QueueFake.php[39m:[32m128[39m
    124â–•     protected function assertPushedTimes($job, $times = 1)
    125â–•     {
    126â–•         $count = $this->pushed($job)->count();
    127â–• 
  âžœ 128â–•         PHPUnit::assertSame(
    129â–•             $times, $count,
    130â–•             sprintf(
    131â–•                 "The expected [{$job}] job was pushed {$count} %s instead of {$times} %s.",
    132â–•                 Str::plural('time', $count),

      [2m+3 vendor frames [22m
  [33m4   [39m[39;1mtests/Feature/ErrorRecoveryTest.php[39;22m:[39;1m243[39;22m

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ErrorRecoveryTest[22m [90m>[39m handles invalid csrf token         
[39;1m  Failed asserting that an array contains 405.[39;22m

  at [32mtests/Feature/ErrorRecoveryTest.php[39m:[32m343[39m
    339â–• 
    340â–•     /**
    341â–•      * Should handle gracefully (middleware disabled for test)
    342â–•      */
  âžœ 343â–•     expect($response->getStatusCode())->toBeIn([200, 302, 419]);
    344â–• })->group('error-recovery');
    345â–• 
    346â–• /*
    347â–• |--------------------------------------------------------------------------

  [33m1   [39m[39;1mtests/Feature/ErrorRecoveryTest.php[39;22m:[39;1m343[39;22m

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ErrorRecoveryTest[22m [90m>[39m handles invalid chat id format     
[39;1m  Expected response status code [422] but received 403.
Failed asserting that 403 is identical to 422.[39;22m

  at [32mtests/Feature/ErrorRecoveryTest.php[39m:[32m477[39m
    473â–• 
    474â–•     /**
    475â–•      * Should validate and reject
    476â–•      */
  âžœ 477â–•     $response->assertStatus(422);
    478â–• })->group('error-recovery');
    479â–•

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\IntegrationTest[22m [90m>[39m complete user journey: register tâ€¦   
[39;1m  Failed asserting that two strings are equal.
  [39;22m[31m-'http://localhost'[39m[39;1m
  [39;22m[32m+'http://localhost/chat'[39m[39;1m
  [39;22m

  at [32mtests/Feature/IntegrationTest.php[39m:[32m33[39m
     29â–•         'password_confirmation' => 'password123',
     30â–•     ];
     31â–• 
     32â–•     $registerResponse = $this->post('/register', $userData);
  âžœ  33â–•     $registerResponse->assertRedirect('/');
     34â–• 
     35â–•     $user = User::where('email', 'test@example.com')->first();
     36â–•     expect($user)->not->toBeNull();
     37â–•     expect($user->name)->toBe('Test User');

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\IntegrationTest[22m [90m>[39m avatar upload and profile updateâ€¦    
[39;1m  Expected response status code [201, 301, 302, 303, 307, 308] but received 405.
Failed asserting that false is true.[39;22m

  at [32mtests/Feature/IntegrationTest.php[39m:[32m255[39m
    251â–•             'name' => 'Updated Name',
    252â–•             'email' => 'original@example.com',
    253â–•         ]);
    254â–• 
  âžœ 255â–•     $profileResponse->assertRedirect();
    256â–• 
    257â–•     $user->refresh();
    258â–•     expect($user->name)->toBe('Updated Name');
    259â–•

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\IntegrationTest[22m [90m>[39m password change and re-authenticaâ€¦   
[39;1m  Failed asserting that two strings are equal.
  [39;22m[31m-'http://localhost'[39m[39;1m
  [39;22m[32m+'http://localhost/chat'[39m[39;1m
  [39;22m

  at [32mtests/Feature/IntegrationTest.php[39m:[32m312[39m
    308â–•         'email' => $user->email,
    309â–•         'password' => 'oldpassword123',
    310â–•     ]);
    311â–• 
  âžœ 312â–•     $loginResponse->assertRedirect('/');
    313â–• 
    314â–•     /**
    315â–•      * Step 2: Change Password
    316â–•      */

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\IntegrationTest[22m [90m>[39m two-factor authentication completâ€¦   
[39;1m  Expected response status code [201, 301, 302, 303, 307, 308] but received 405.
Failed asserting that false is true.[39;22m

  at [32mtests/Feature/IntegrationTest.php[39m:[32m362[39m
    358â–•      */
    359â–•     $enableResponse = $this->actingAs($user)
    360â–•         ->post('/settings/two-factor-authentication');
    361â–• 
  âžœ 362â–•     $enableResponse->assertRedirect();
    363â–• 
    364â–•     $user->refresh();
    365â–•     expect($user->two_factor_secret)->not->toBeNull();
    366â–•

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ConcurrencyTest[22m [90m>[39m concurrent chat deletions are ideâ€¦   
[39;1m  Failed asserting that false is true.[39;22m

  at [32mtests/Feature/ConcurrencyTest.php[39m:[32m235[39m
    231â–•      * All messages should be soft deleted
    232â–•      */
    233â–•     $deletedMessages = Message::withTrashed()->where('chat_id', $chatId)->get();
    234â–•     foreach ($deletedMessages as $message) {
  âžœ 235â–•         expect($message->trashed())->toBeTrue();
    236â–•     }
    237â–• });
    238â–• 
    239â–• test('concurrent chat updates maintain consistency', function () {

  [33m1   [39m[39;1mtests/Feature/ConcurrencyTest.php[39;22m:[39;1m235[39;22m

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ConcurrencyTest[22m [90m>[39m concurrent queue job execution maâ€¦   
[39;1m  The expected [App\Jobs\GenerateChatTitle] job was pushed 0 times instead of 3 times.
Failed asserting that 0 is identical to 3.[39;22m

  at [32mvendor/laravel/framework/src/Illuminate/Support/Testing/Fakes/QueueFake.php[39m:[32m128[39m
    124â–•     protected function assertPushedTimes($job, $times = 1)
    125â–•     {
    126â–•         $count = $this->pushed($job)->count();
    127â–• 
  âžœ 128â–•         PHPUnit::assertSame(
    129â–•             $times, $count,
    130â–•             sprintf(
    131â–•                 "The expected [{$job}] job was pushed {$count} %s instead of {$times} %s.",
    132â–•                 Str::plural('time', $count),

      [2m+3 vendor frames [22m
  [33m4   [39m[39;1mtests/Feature/ConcurrencyTest.php[39;22m:[39;1m406[39;22m

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\RateLimitingTest[22m [90m>[39m chat stream enforces configuredâ€¦    
[39;1m  Failed asserting that false is true.[39;22m

  at [32mtests/Feature/RateLimitingTest.php[39m:[32m59[39m
     55â–• 
     56â–•     /**
     57â–•      * Verify rate limit headers on blocked request
     58â–•      */
  âžœ  59â–•     expect($blockedResponse->headers->has('X-RateLimit-Limit'))->toBeTrue();
     60â–•     expect($blockedResponse->headers->get('X-RateLimit-Remaining'))->toBe('0');
     61â–• });
     62â–• 
     63â–• test('rate limit resets after time window', function () {

  [33m1   [39m[39;1mtests/Feature/RateLimitingTest.php[39;22m:[39;1m59[39;22m

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\AvatarUploadTest[22m [90m>[39m it can disconnect social account    
[39;1m  Failed asserting that a row in the table [social_identities] matches the attributes {
    "id": 1,
    "user_id": 1,
    "provider": "github"
}.

Found similar results: [
    {
        "id": 1,
        "user_id": 1,
        "\"provider\"": "provider"
    }
].[39;22m

  at [32mtests/Feature/AvatarUploadTest.php[39m:[32m144[39m
    140â–• it('can disconnect social account', function () {
    141â–•     $user = User::factory()->create();
    142â–•     $socialIdentity = SocialIdentity::factory()->github()->create(['user_id' => $user->id]);
    143â–• 
  âžœ 144â–•     assertDatabaseHas('social_identities', [
    145â–•         'id' => $socialIdentity->id,
    146â–•         'user_id' => $user->id,
    147â–•         'provider' => 'github',
    148â–•     ]);

  [31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m  
  [41;1m FAILED [49;22m [1mTests\Feature\ChatAuthorizationTest[22m [90m>[39m users can delete their ownâ€¦    
[39;1m  Failed asserting that false is true.[39;22m

  at [32mtests/Feature/ChatAuthorizationTest.php[39m:[32m134[39m
    130â–•     /**
    131â–•      * Verify messages are also soft deleted
    132â–•      */
    133â–•     foreach ($messages as $message) {
  âžœ 134â–•         expect($message->fresh()->trashed())->toBeTrue();
    135â–•     }
    136â–• });
    137â–• 
    138â–• test('deleting non-existent chat returns 404', function () {

  [33m1   [39m[39;1mtests/Feature/ChatAuthorizationTest.php[39;22m:[39;1m134[39;22m


  [90mTests:[39m    [31;1m33 failed[39;22m[90m,[39m[39m [39m[33;1m2 skipped[39;22m[90m,[39m[39m [39m[32;1m171 passed[39;22m[90m (563 assertions)[39m
  [90mDuration:[39m [39m12.70s[39m

[1A  [90mParallel:[39m [39m12 processes[39m

